# ============================================================================
# EchoNote Backend Environment Configuration
# ============================================================================
#
# SECURITY WARNING: DO NOT commit the actual .env file to version control!
# This is a template file. Copy it to .env and fill in actual values.
#
# cp .env.example .env
#
# ============================================================================

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================

# PostgreSQL (Production - Recommended)
# DATABASE_URL=postgresql://username:password@hostname:5432/database_name

# Kubernetes/OpenShift PostgreSQL (using individual credentials)
# POSTGRESQL_USER=echonote
# POSTGRESQL_PASSWORD=your_secure_password_here
# POSTGRESQL_DATABASE=echonote
# POSTGRESQL_HOST=postgresql
# POSTGRESQL_PORT=5432

# SQLite (Development Only - DO NOT use in production)
SQLITE_DB=echonote.db

# Database debugging (set to "true" to log all SQL queries)
DB_ECHO=false

# ============================================================================
# SECURITY - JWT AUTHENTICATION
# ============================================================================

# CRITICAL: Generate a secure random secret key for production!
#
# Generate a new secret with:
#   python3 -c "import secrets; print(secrets.token_urlsafe(64))"
#
# NEVER use the default value in production!
# NEVER commit actual secret keys to version control!
#
JWT_SECRET_KEY=CHANGE_THIS_TO_SECURE_RANDOM_STRING_MINIMUM_64_CHARACTERS_IN_PRODUCTION

# JWT Configuration
JWT_ALGORITHM=HS256

# Phase 4.1: Security Fix - Shorter token lifetimes for better security
#
# Access Token Lifetime (in minutes, default: 15)
# - Short-lived tokens reduce risk if compromised
# - Recommended: 15-60 minutes
ACCESS_TOKEN_EXPIRE_MINUTES=15

# Refresh Token Lifetime (in days, default: 7)
# - Long-lived tokens for extended sessions
# - Users can get new access tokens without re-logging in
# - Recommended: 7-30 days
REFRESH_TOKEN_EXPIRE_DAYS=7

# Legacy Compatibility:
# If you prefer the old 30-day access tokens (NOT recommended for production):
# ACCESS_TOKEN_EXPIRE_DAYS=30
# Note: This will override ACCESS_TOKEN_EXPIRE_MINUTES if set

# ============================================================================
# API KEYS
# ============================================================================

# vLLM API Key for Whisper transcription
API_KEY=your_vllm_api_key_here

# AI Assistant API Key (for future AI action implementation)
ASSISTANT_API_KEY=your_assistant_api_key_here

# ============================================================================
# LLAMASTACK CONFIGURATION (AI Actions)
# ============================================================================

# LlamaStack server URL for AI actions (summarization, content generation, etc.)
# Example: http://localhost:5001 or https://llamastack.yourdomain.com
LLAMA_SERVER_URL=

# LlamaStack model name to use for AI actions
# Example: meta-llama/Llama-3.2-3B-Instruct
LLAMA_MODEL_NAME=

# LlamaStack client API key
# Set to "fake" for local development without authentication
# Use actual API key for production deployments
LLAMA_STACK_CLIENT_API_KEY=fake

# ============================================================================
# CORS CONFIGURATION
# ============================================================================

# Allowed CORS origins (comma-separated, no spaces)
# Development example:
CORS_ORIGINS=http://localhost:5173,http://localhost:3000

# Production example:
# CORS_ORIGINS=https://yourdomain.com,https://www.yourdomain.com

# ============================================================================
# UPLOAD LIMITS
# ============================================================================

# Maximum upload file size in bytes (default: 50MB)
MAX_UPLOAD_SIZE=52428800

# Maximum audio duration in seconds (default: 1 hour)
MAX_AUDIO_DURATION_SECONDS=3600

# ============================================================================
# MINIO OBJECT STORAGE
# ============================================================================

# MinIO S3-compatible object storage for audio files
# Storing audio in object storage instead of PostgreSQL BLOBs prevents
# database crashes and improves performance for large files.

# MinIO server endpoint (hostname:port)
# Development: localhost:9000
# Kubernetes/OpenShift: minio:9000 (internal service name)
MINIO_ENDPOINT=minio:9000

# MinIO access credentials
# SECURITY WARNING: Change these default credentials in production!
# Use strong random values (minimum 16 characters for password)
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin123

# MinIO bucket name for storing audio files
# Bucket will be created automatically if it doesn't exist
MINIO_BUCKET=echonote-audio

# Use HTTPS for MinIO connection (true/false)
# Set to "true" if MinIO is behind TLS/HTTPS
# Set to "false" for local development or internal cluster communication
MINIO_SECURE=false

# ============================================================================
# REDIS / CELERY CONFIGURATION
# ============================================================================

# Redis URL for Celery broker and rate limiting
REDIS_URL=redis://localhost:6379

# Celery broker (task queue)
CELERY_BROKER_URL=redis://localhost:6379/0

# Celery result backend (task results storage)
CELERY_RESULT_BACKEND=redis://localhost:6379/1

# ============================================================================
# TRANSCRIPTION MODELS
# ============================================================================

# Available Whisper models (JSON format)
# Format: {"model_name": "http://vllm-server:port/v1"}
MODELS={"whisper-large-v3-turbo-quantizedw4a16":"http://localhost:8001/v1","kb-whisper-large":"http://localhost:8002/v1"}

# Default model to use
DEFAULT_MODEL=whisper-large-v3-turbo-quantizedw4a16

# Speaker diarization model (Hugging Face model ID)
DIARIZATION_MODEL=pyannote/speaker-diarization-3.1

# Hugging Face token (required for diarization models)
# Get yours at: https://huggingface.co/settings/tokens
HUGGINGFACE_TOKEN=your_huggingface_token_here

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================

# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Log file directory (relative to backend/)
LOG_FILE_PATH=logs/

# ============================================================================
# APPLICATION SETTINGS
# ============================================================================

# Application host and port (for development server)
APP_HOST=0.0.0.0
APP_PORT=8000

# Audio chunking duration for long recordings (seconds)
CHUNK_DURATION_SECONDS=60

# ============================================================================
# RATE LIMITING
# ============================================================================

# Redis database for rate limiting (separate from Celery)
RATE_LIMIT_REDIS_URL=redis://localhost:6379/2

# Default rate limit for all endpoints
DEFAULT_RATE_LIMIT=100/minute

# ============================================================================
# PRODUCTION CHECKLIST
# ============================================================================
#
# Before deploying to production, ensure:
#
# [ ] JWT_SECRET_KEY is changed to a secure random value (64+ characters)
# [ ] DATABASE_URL points to PostgreSQL (not SQLite)
# [ ] All API_KEY values are set
# [ ] CORS_ORIGINS only includes production domains
# [ ] LOG_LEVEL is set to INFO or WARNING
# [ ] DB_ECHO is set to false
# [ ] MinIO credentials (MINIO_ACCESS_KEY, MINIO_SECRET_KEY) are changed
# [ ] MinIO is deployed and accessible
# [ ] Redis is configured with persistence
# [ ] Celery worker and Beat are running
# [ ] HTTPS/TLS is configured at reverse proxy level
# [ ] Regular backups are configured (database + MinIO bucket)
# [ ] Monitoring and alerting are set up
#
# ============================================================================
